Old, first pass at implementation
